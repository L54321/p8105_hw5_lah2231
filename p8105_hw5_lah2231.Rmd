---
title: "p8105_hw5_lah2231"
output: github_document
date: "2024-11-12"
---
```{r}
library(tidyverse)
library(broom)
```


# Problem 2

## T-Test simulation function
```{r}
n <- 30
sigma <- 5
mu_values <- c(0, 1, 2, 3, 4, 5, 6)
num_simulations <- 5000
alpha <- 0.05

simulate_t_test <- function(mu) {
  sample_data <- rnorm(n, mean = mu, sd = sigma)
  
  test_result <- t.test(sample_data, mu = 0)
  
  result <- tidy(test_result) %>% 
    select(estimate, p.value)
  
  result
}
```

## Running Simulation
```{r}
simulation_results <- expand_grid(mu = mu_values, sim = 1:num_simulations) |>
  mutate(result = map(mu, simulate_t_test)) |>
  unnest(result)
```

## Calculating Power
```{r}
power_results <- simulation_results %>%
  group_by(mu) %>%
  summarize(power = mean(p.value < alpha))
```

## Plotting Power
```{r}
power_results %>%
  ggplot(aes(x = mu, y = power)) +
  geom_line() +
  labs(x = "True Mean (mu)", y = "Power", title = "Power vs. Effect Size (True Mean)")
```
## Calculating averga Eestimate of mu_hat
```{r}
average_mu_hat <- simulation_results %>%
  group_by(mu) %>%
  summarize(
    avg_mu_hat = mean(estimate),
    avg_mu_hat_rejected = mean(estimate[p.value < alpha])
  )
```

## Plotting average estimate of mu_hat vs. true mean
```{r}
average_mu_hat %>%
  ggplot(aes(x = mu)) +
  geom_line(aes(y = avg_mu_hat, color = "Average mu_hat")) +
  geom_line(aes(y = avg_mu_hat_rejected, color = "Average mu_hat (Rejected)")) +
  labs(x = "True mean (mu)", y = "Average estimate of mu_hat",
       title = "Average estimate of mu_hat vs. true mean") +
  scale_color_manual(values = c("Average mu_hat" = "blue", "Average mu_hat (Rejected)" = "red"))
```

# Problem 3

## Loading Data Homicides
```{r}
library(readr)

url <- "https://raw.githubusercontent.com/washingtonpost/data-homicides/master/homicide-data.csv"

homicide_data <- read_csv(url)

head(homicide_data)
```

```{r}
dim(homicide_data)
summary(homicide_data)
```

This dataset about homicides in major US cities contains `r ncol(homicide_data)` columns and `r nrow(homicide_data)` rows. There are `r sum(is.na(homicide_data))` missing values across the dataset. The columns include: `r names(homicide_data)`.

## Creating City State Column and finding total and unsolved homicides
```{r}
homicide_data <- mutate(homicide_data, city_state = paste(city, state, sep = ", "))

homicide_summary <- homicide_data |>
  group_by(city_state) |>
  summarize(
    total_homicides = n(),
    unsolved_homicides = sum(disposition %in% c("Closed without arrest", "Open/No arrest")),
    .groups = "drop"
  )

head(homicide_summary)
```

This table summarizes all homicides across the `r nrow(homicide_summary)` cities, including the total number of homicides (`r sum(pull(homicide_summary, total_homicides))`) with `r sum(pull(homicide_summary, unsolved_homicides))` unsolved cases.







